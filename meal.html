
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>잡곡 사용량 계산</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }
    h1 {
        text-align: center;
        cursor: pointer;
    }
    form {
        max-width: 100%;
        margin: 0 auto;
    }
    label {
        display: block;
        margin-bottom: 10px;
    }
    .form-group {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        margin-bottom: 10px;
    }
    .form-group label {
        flex: 0 0 45%;
        margin: 0;
    }
    .form-group input,
    .form-group select {
        flex: 1 1 55%;
        padding: 8px;
        margin: 0;
        box-sizing: border-box;
    }
    input[type="submit"] {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        width: 100%;
        box-sizing: border-box;
    }
    input[type="submit"]:hover {
        background-color: #45a049;
    }
    #grain-checkboxes {
        display: flex;
        flex-wrap: wrap;
    }
    #grain-checkboxes label {
        flex: 1 1 45%;
        margin-right: 20px;
        box-sizing: border-box;
    }
    @media (max-width: 600px) {
        #grain-checkboxes label {
            flex: 1 1 100%;
            margin-right: 0;
        }
        .form-group label,
        .form-group input,
        .form-group select {
            flex: 1 1 100%;
        }
        .title {
            font-size: 80pt; /* 원하는 크기로 조정 */
            text-align: center;
            font-weight: bold;
            color: #0057A1; /* 정부청색 */
            font-family: 'HakgyoansimKkokkomaR', sans-serif;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2); /* 그림자 설정 */
            cursor: pointer;
            margin-left: 10px; /* 이미지와 타이틀 간격 */
            margin-top: 20px; /* 메뉴를 위로 이동 */
            margin-bottom: 40px; /* 타이틀과 폼 간격 추가 */
        }
        .title img {
            width: 100px;
            height: auto;
            margin-right: 10px;
        }

        .item {
   /*         border: 1px solid #000;*/
            padding: 10px;
            text-align: center;
            max-width: 100%;
            box-sizing: border-box;
        }
        .item img {
            max-width: 80px;
            height: auto;
            cursor: pointer;
        }
        
                /* 모달 스타일링 */

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9);
        }
        .modal-content {
            margin: auto;
            display: block;
            width: 100%;
            max-width: 900px;
            justify-content: center;
            text-align: center; /* Center-align contents including images */
        }

        .modal-content img {
            width: 70%; /* Adjust width as needed */
            height: auto; /* Maintain aspect ratio */
            margin: auto; /* Center-align the image horizontally */
            display: block; /* Ensure image behaves as a block element */
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
/*            transition: 0.3s;*/
        }
        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
    }
</style>
</head>
<body>

<h1>잡곡 사용량 계산</h1>

    <div class="title-container">
        <h1 class="title" onclick="window.location.reset();">
                <img src="/pages/ssal.png" alt="" onclick="openModal('/pages/ssal.png')">
                 </h1>
    </div>    
    <!-- 모달 요소 -->
    <div id="myModal" class="modal">
        <span class="close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <img id="modal-image" src="">
        </div>
    </div>


<form id="grain-consumption-form">
    <h2>가구의 한달 식사수</h2>
    <div class="form-group">
        <label for="days">한달의 일수:</label>
        <select id="days" name="days" required>
            <option value="28">28일</option>
            <option value="29">29일</option>
            <option value="30">30일</option>
            <option value="31">31일</option>
        </select>
    </div>
    <div class="form-group">
        <label for="entertainment_times">가구의 한달 접대 횟수(잡곡 사용량 계산 위해 대체식품은 접대에서 제외):</label>
        <input type="number" id="entertainment_times" name="entertainment_times" placeholder="가구의 한달 동안의 접대 횟수를 입력하세요" required>
    </div>
    <div class="form-group">
        <label for="entertainer_meals">가구의 접대인의 한끼 식사량(kg):</label>
        <input type="number" id="entertainer_meals" name="entertainer_meals" step="0.01" placeholder="접대인의 한끼 식사량을 입력하세요" required>
    </div>
    <div class="form-group">
        <label for="household_size">가구 인원수:</label>
        <input type="number" id="household_size" name="household_size" min="1" max="8" placeholder="가구 인원수를 입력하세요" required>
    </div>

    <div id="household-members"></div>

    <!-- 양곡 종류 및 비율 입력란 -->
    <h2>사용 잡곡</h2>
    <div id="grain-checkboxes"></div>

    <h2>잡곡 사용 비율 입력</h2>
    <div id="grain-ratio-inputs"></div>

    <input type="submit" value="계산하기">
</form>


    
<script>
    document.getElementById("household_size").addEventListener("change", function() {
        let householdSize = parseInt(this.value);
        let householdMembersDiv = document.getElementById("household-members");

        // 기존에 생성된 입력란 삭제
        householdMembersDiv.innerHTML = "";

        // 가구원 수에 맞게 입력란 동적 생성
        for (let i = 1; i <= householdSize; i++) {
            let formGroup1 = document.createElement("div");
            formGroup1.className = "form-group";
            let label1 = document.createElement("label");
            label1.textContent = "가구원" + i + "의 1끼 식사량(kg):";
            let input1 = document.createElement("input");
            input1.type = "number";
            input1.id = "member-meals-" + i;
            input1.name = "member-meals-" + i;
            input1.placeholder = "가구원" + i + "의 1끼 식사량을 입력하세요";
            input1.required = true;
            input1.step = "0.01";

            formGroup1.appendChild(label1);
            formGroup1.appendChild(input1);

            let formGroup2 = document.createElement("div");
            formGroup2.className = "form-group";
            let label2 = document.createElement("label");
            label2.textContent = "가구원" + i + "의 한달 외식수:";
            let input2 = document.createElement("input");
            input2.type = "number";
            input2.id = "member-eating-out-" + i;
            input2.name = "member-eating-out-" + i;
            input2.placeholder = "가구원" + i + "의 한달 동안 외식한 횟수를 입력하세요";
            input2.required = true;

            formGroup2.appendChild(label2);
            formGroup2.appendChild(input2);

            let formGroup3 = document.createElement("div");
            formGroup3.className = "form-group";
            let label3 = document.createElement("label");
            label3.textContent = "가구원" + i + "의 한달 결식수(잡곡 사용량 계산 위해 대체식품은 결식에 포함):";
            let input3 = document.createElement("input");
            input3.type = "number";
            input3.id = "member-skipped-meals-" + i;
            input3.name = "member-skipped-meals-" + i;
            input3.placeholder = "가구원" + i + "의 한달 동안 결식한 횟수를 입력하세요";
            input3.required = true;

            formGroup3.appendChild(label3);
            formGroup3.appendChild(input3);

            householdMembersDiv.appendChild(formGroup1);
            householdMembersDiv.appendChild(formGroup2);
            householdMembersDiv.appendChild(formGroup3);
        }
    });

    document.getElementById("grain-checkboxes").addEventListener("change", function() {
        let checkedGrains = document.querySelectorAll("input[name='grain-checkbox']:checked");
        let grainRatioInputs = document.getElementById("grain-ratio-inputs");

        grainRatioInputs.innerHTML = ""; // 이전 내용 초기화

        // 선택된 양곡에 대해 비율 입력란 생성
        checkedGrains.forEach(function(grain) {
            let grainIndex = parseInt(grain.value);
            let grainLabel = grain.dataset.label;

            let formGroup = document.createElement("div");
            formGroup.className = "form-group";
            let label = document.createElement("label");
            label.textContent = grainLabel + " 사용비율(%):";
            let input = document.createElement("input");
            input.type = "number";
            input.id = "grain-ratio-" + grainIndex;
            input.name = "grain-ratio-" + grainIndex;
            input.placeholder = grainLabel + " 비율을 입력하세요";
            input.required = true;

            formGroup.appendChild(label);
            formGroup.appendChild(input);

            grainRatioInputs.appendChild(formGroup);
        });
    });
 
    document.getElementById("grain-consumption-form").addEventListener("submit", function(event) {
        event.preventDefault();

        let householdSize = parseInt(document.getElementById("household_size").value);
        let days = parseInt(document.getElementById("days").value);

        // 가구원 별로 외식횟수와 결식횟수를 합산
        let totalEatingOut = 0;
        let totalSkippedMeals = 0;
        let totalEntertainment = parseInt(document.getElementById("entertainment_times").value);
        let entertainerMeals = parseInt(document.getElementById("entertainer_meals").value);

        for (let i = 1; i <= householdSize; i++) {
            totalEatingOut += parseInt(document.getElementById("member-eating-out-" + i).value);
            totalSkippedMeals += parseInt(document.getElementById("member-skipped-meals-" + i).value);
        }

        // 한 가구의 총 양곡 소비량 계산
        let totalGrainConsumption =         0;
        for (let i = 1; i <= householdSize; i++) {
            totalGrainConsumption += (parseFloat(document.getElementById("member-meals-" + i).value) * (days * 3));
        }
        totalGrainConsumption += (totalEntertainment * entertainerMeals);

        // 선택된 양곡 비율 입력 및 계산
        let checkedGrains = document.querySelectorAll("input[name='grain-checkbox']:checked");
        let grainUsage = {};
        let totalRatio = 0; // 비율의 합 초기화

        checkedGrains.forEach(function(grain) {
            let grainIndex = parseInt(grain.value);
            let grainRatio = parseFloat(document.getElementById("grain-ratio-" + grainIndex).value);
            let grainLabel = grain.dataset.label;
            grainUsage[grainLabel] = (totalGrainConsumption * grainRatio / 100).toFixed(2);
            totalRatio += grainRatio; // 비율을 합산
        });

        // 비율의 합이 100%가 아닌 경우 알림 표시
        if (totalRatio !== 100) {
            alert("잡곡 비율의 합이 100%가 아닙니다.");
            return; // 계산 중단
        }

        // 결과 표시
        let resultDiv = document.getElementById("result-div");
        if (!resultDiv) {
            resultDiv = document.createElement("div");
            resultDiv.id = "result-div";
            document.body.appendChild(resultDiv);
        }
        resultDiv.innerHTML = "<h2>결과</h2>";
        resultDiv.innerHTML += "<p>가구 한달 잡곡 총 소비량: " + totalGrainConsumption.toFixed(2) + " kg</p>";
        resultDiv.innerHTML += "<p>각 잡곡의 사용량:</p>";
        for (let grain in grainUsage) {
            resultDiv.innerHTML += "<p>" + grain + ": " + grainUsage[grain] + " kg</p>";
        }
        resultDiv.innerHTML += "<p>가구 한달 외식 횟수: " + totalEatingOut + " 회</p>";
        resultDiv.innerHTML += "<p>가구 한달 결식 횟수(대체식품은 결식에 포함): " + totalSkippedMeals + " 회</p>";
        resultDiv.innerHTML += "<p>가구 한달 접대 횟수(대체식품은 접대에서 제외): " + totalEntertainment + " 회</p>";
    });

    // 초기에 양곡 종류 체크박스 생성
    let grains = [
        "멥쌀", "찹쌀", "겉보리쌀", "쌀보리쌀", "맥주보리쌀", "기타맥류", "밀가루", "옥수수", 
        "기타잡곡", "콩", "팥", "땅콩", "기타두류", "고구마", "감자"
    ];

    let grainCheckboxesDiv = document.getElementById("grain-checkboxes");
    grains.forEach(function(grain, index) {
        let label = document.createElement("label");
        let checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.name = "grain-checkbox";
        checkbox.value = index;
        checkbox.dataset.label = grain;
        label.appendChild(checkbox);
        label.appendChild(document.createTextNode(grain));
        grainCheckboxesDiv.appendChild(label);
    });

    document.querySelector("h1").addEventListener("click", function() {
        // 페이지 새로고침
        location.reload();
    });

            /*이미지 스크립트*/

        function openModal(src) {
            document.getElementById('modal-image').src = src;
            document.getElementById('myModal').style.display = "block";
        }

        function closeModal() {
            document.getElementById('myModal').style.display = "none";
        }        


</script>

</body>
</html>

