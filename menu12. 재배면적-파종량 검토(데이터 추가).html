<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>파종량/재배면적 검토</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    .container {
        max-width: 400px;
        margin: 0 auto;
        text-align: center;
    }
    input[type="number"], select {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        box-sizing: border-box;
    }
    button {
        background-color: #007bff;
        color: white;
        padding: 10px 20px;
        margin: 8px 0;
        border: none;
        cursor: pointer;
        width: 100%;
    }
    button:hover {
        opacity: 0.8;
    }
    h2 {
        cursor: pointer;
    }
</style>
</head>
<body>
<div class="container">
    <h2 onclick="resetForm()">파종량/재배면적 검토</h2>
    <strong><label for="crop">작물 선택</label></strong>
    <select id="crop" onchange="updateUnit()">
        <option value="논벼">논벼</option>
        <option value="고추">고추</option>
        <option value="콩">콩</option>
        <option value="마늘">마늘</option>
        <option value="양파">양파</option>
    </select>
    <strong><label for="area">재배면적</label></strong>
    <input type="number" id="area" placeholder="재배면적을 입력하세요">
    <select id="unit">
        <option value="m2">m²</option>
        <option value="평">평</option>
        <option value="마지기">마지기</option>
        <option value="a">a</option>
    </select>
    <strong><label for="seeds">파종량</label></strong>
    <input type="number" id="seeds" placeholder="파종량을 입력하세요">
    <span id="seedUnit">kg</span>
    <button onclick="calculate()">검토</button>
    <p id="result"></p>
</div>

<script>
function updateUnit() {
    var crop = document.getElementById("crop").value;
    var seedUnit = document.getElementById("seedUnit");

    if (crop === "논벼" || crop === "콩" || crop === "마늘") {
        seedUnit.textContent = "kg";
    } else if (crop === "고추" || crop === "양파") {
        seedUnit.textContent = "g";
    }
}

function calculate() {
    var area = document.getElementById("area").value;
    var selectedUnit = document.getElementById("unit").value;
    var seeds = document.getElementById("seeds").value;
    var selectedCrop = document.getElementById("crop").value;

    // Convert area to square meters based on selected unit
    switch(selectedUnit) {
        case "평":
            area *= 3.3;
            break;
        case "마지기":
            area *= 660;
            break;
        case "a":
            area *= 100;
            break;
        default:
            // Assume area is already in square meters
            break;
    }

    // Validation for area input
    if (area === "" || area <= 0) {
        alert("유효한 재배면적을 입력하세요.");
        return;
    }

    // Validation for seeds input
    if (seeds === "" || seeds <= 0) {
        alert("유효한 파종량을 입력하세요.");
        return;
    }

    // Convert seeds to the appropriate unit
    var seedUnit = document.getElementById("seedUnit").textContent;
    if (seedUnit === "g") {
        seeds = parseFloat(seeds) / 1000;  // Convert grams to kilograms
    } else {
        seeds = parseFloat(seeds);
    }

    // Calculate seeding rate per square meter
    var seedingRatePerMeter = seeds / area * 1000;

    // Expected seeding rate for selected crop
    var expectedSeedingRates = {
        "논벼": 6.75,
        "고추": 24.71,
        "콩": 6.11,
        "마늘": 182.73,
        "양파": 210.1
    };
    var expectedSeedingRate = expectedSeedingRates[selectedCrop];

    // Calculate the percentage difference
    var percentageDifference = ((seedingRatePerMeter - expectedSeedingRate) / expectedSeedingRate) * 100;

    // Determine the message and color based on the percentage difference
    var message = "";
    var color = "";
    if (percentageDifference >= 20) {
        message = "<strong>작물재배면적 대비 파종량이 너무 많습니다.</strong>";
        color = "red";
    } else if (percentageDifference >= 15) {
        message = "<strong>작물재배면적 대비 파종량이 다소 많습니다.</strong>";
        color = "orange";
    } else if (percentageDifference >= -15 && percentageDifference <= 15) {
        message = "<strong>작물재배면적 대비 파종량이 적정 범위에 있습니다.</strong>";
        color = "blue";
    } else if (percentageDifference <= -20) {
        message = "<strong>작물재배면적 대비 파종량이 너무 적습니다.</strong>";
        color = "red";
    } else if (percentageDifference <= -15) {
        message = "<strong>작물재배면적 대비 파종량이 다소 적습니다.</strong>";
        color = "orange";
}

// Additional messages
var inputSeedingRatePer10a = seeds * 10 / area;
var expectedSeedingRatePer10a = expectedSeedingRate;
var errorPercentage = Math.abs(percentageDifference);

var additionalMessages = `
    <span style="color: black;">입력한 값의 10a당 파종량은 <span style="color: ${color};">${(inputSeedingRatePer10a * 100).toFixed(2)}kg</span>입니다.</span><br>
    <span style="color: black;">입력값의 오차가 <span style="color: ${color};">${errorPercentage.toFixed(2)}%</span>입니다.</span><br>
    <strong><span style="color: black;">대상작물의 적정 10a당 파종량: <span style="color: blue;">${expectedSeedingRatePer10a}kg</span> <br>
`;

// Calculate seeding amount for the entered area based on unit
var seedingAmount;
switch(selectedUnit) {
    case "m2":
        seedingAmount = (expectedSeedingRatePer10a / 1000) * area;
        break;
    case "평":
        seedingAmount = (expectedSeedingRatePer10a / 1000) * (area * 3.3);
        break;
    case "a":
        seedingAmount = (expectedSeedingRatePer10a / 1000) * (area * 100);
        break;
    case "마지기":
        seedingAmount = (expectedSeedingRatePer10a / 1000) * (area * 660);
        break;
}

var errorRange2 = seedingAmount * 0.2;

additionalMessages += `
    <strong><span style="color: black;">입력한 재배면적에 대한 적정 파종량: <span style="color: blue;">${seedingAmount.toFixed(2)}kg</span></span><br>
    (±20% 오차범위: <span style="color: blue;">${(seedingAmount - errorRange2).toFixed(2)}kg ~ ${(seedingAmount + errorRange2).toFixed(2)}kg)</span></strong><br>

`;

// Display the result
var resultElement = document.getElementById("result");
resultElement.style.color = color;
resultElement.innerHTML = message + "<br>" + additionalMessages;

// Reset the form fields
document.getElementById("area").value = "";
document.getElementById("seeds").value = "";
}

document.addEventListener("DOMContentLoaded", function() {
updateUnit();
});
</script>

</body>
</html>

